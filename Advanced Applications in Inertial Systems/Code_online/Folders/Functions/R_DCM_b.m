function dcm = R_DCM_b( r1, r2, r3 )
% -------------------------- Description ------------------------- %
%                                                                  %
%               Convert Euler angles to DCM matrix                 %
%                                                                  %
% --------------------------- Content ---------------------------- %

angles = [r1(:) r2(:) r3(:)];
dcm = zeros(3, 3, size(angles,1) );
[c, s] = deal( cos( angles ), sin( angles ) );

% ---------------- Define the DCM output matrix ----------------- %
dcm(1,1,:) = c(:,2).*c(:,3);
dcm(1,2,:) = s(:,1).*s(:,2).*c(:,3) + c(:,1).*s(:,3);
dcm(1,3,:) = -c(:,1).*s(:,2).*c(:,3) + s(:,1).*s(:,3);
dcm(2,1,:) = -c(:,2).*s(:,3);
dcm(2,2,:) = -s(:,1).*s(:,2).*s(:,3) + c(:,1).*c(:,3);
dcm(2,3,:) = c(:,1).*s(:,2).*s(:,3) + s(:,1).*c(:,3);
dcm(3,1,:) = s(:,2);
dcm(3,2,:) = -s(:,1).*c(:,2);
dcm(3,3,:) = c(:,1).*c(:,2);

end

